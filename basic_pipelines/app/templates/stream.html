<!DOCTYPE html>
<html lang="fr">

<head>
      <meta charset="UTF-8">
      <title>WetTheCat - Stream</title>
      <link rel="stylesheet" href="/static/css/styles.css">
      <style>
            body {
                  display: flex;
                  justify-content: center;
                  align-items: center;
                  height: 100vh;
                  background-color: #222;
                  margin: 0;
                  color: #fff;
                  flex-direction: column;
            }

            video {
                  max-width: 80%;
                  max-height: 80%;
                  border: 2px solid #fff;
            }

            .back-link,
            .logout-button {
                  margin-top: 20px;
                  color: #fff;
                  text-decoration: none;
                  background-color: #555;
                  padding: 10px 20px;
                  border-radius: 5px;
                  cursor: pointer;
                  border: none;
                  font-size: 16px;
            }

            .back-link:hover,
            .logout-button:hover {
                  background-color: #777;
            }
      </style>
</head>

<body>
      <div class="container">
            <h2>Live Stream</h2>
            <video id="video" controls autoplay muted></video>
            <a href="/" class="back-link">Retour à l'Accueil</a>
            <button id="logout-button" class="logout-button">Logout</button>
      </div>

      <!-- Inclure hls.js depuis un CDN -->
      <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
      <script>
            const video = document.getElementById('video');
            const videoSrc = 'https://www.boissard.net/stream/hls/stream.m3u8';

            if (Hls.isSupported()) {
                  const hls = new Hls();
                  hls.loadSource(videoSrc);
                  hls.attachMedia(video);
                  hls.on(Hls.Events.MANIFEST_PARSED, function () {
                        video.play();
                  });
            }
            else if (video.canPlayType('application/vnd.apple.mpegurl')) {
                  video.src = videoSrc;
                  video.addEventListener('loadedmetadata', function () {
                        video.play();
                  });
            }

            document.getElementById('logout-button').addEventListener('click', async () => {
                  // Envoyer une requête pour supprimer le cookie côté serveur
                  await fetch('/logout', {
                        method: 'POST',
                  });
                  window.location.href = '/login';
            });
      </script>
</body>

</html>